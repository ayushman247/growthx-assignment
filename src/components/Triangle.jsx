import { useState, useEffect, useRef } from "react"
import { motion, useAnimationControls } from "framer-motion"


export default function AnimatedTriangular({ isAnimating }) {
  const [gradientPosition, setGradientPosition] = useState(0)
  const controls = useAnimationControls()
  const intervalRef = useRef(null);
const animationActive = useRef(false);

  useEffect(() => {
    if (intervalRef.current) {
      clearInterval(intervalRef.current)
      intervalRef.current = null
    }

    setGradientPosition(0)
    animationActive.current = false

    if (isAnimating) {
      animateGradient()
    }

    return () => {
      if (intervalRef.current) {
        clearInterval(intervalRef.current)
      }
    }
  }, [isAnimating])

  const animateGradient = async () => {
    if (animationActive.current) return
    animationActive.current = true

    await controls.start({
      fillOpacity: 1,
      transition: { duration: 0.5 },
    })

    let position = 0
    intervalRef.current = setInterval(() => {
      position += 1
      setGradientPosition(position)

      if (position >= 100) {
        if (intervalRef.current) {
          clearInterval(intervalRef.current)
          intervalRef.current = null
        }
        setTimeout(() => {
          setGradientPosition(0)
          controls.start({
            fillOpacity: 0,
            transition: { duration: 0.5 },
          })
          animationActive.current = false
        }, 1000)
      }
    }, 20)
  }

  return (
    <motion.div
      className="flex items-center justify-center w-[601px] h-[200px]"
      initial={{ opacity: 0, y: 0 }}
      animate={
        isAnimating
          ? {
              opacity: [0, 1, 1, 1, 1, 1, 1, 1, 0],
            }
          : { opacity: 0 }
      }
      transition={{
        duration: 4,
        ease: "easeInOut",
        times: [0, 0.1, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 1],
      }}
    >
      <svg width="250" height="250" viewBox="0 0 601 317" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="gradientMask" x1="0%" y1="100%" x2="100%" y2="0%">
            <stop offset={`${gradientPosition}%`} stopColor="black" />
            <stop offset={`${Math.min(gradientPosition + 30, 100)}%`} stopColor="white" />
          </linearGradient>

          <mask id="triangleMask">
            <rect width="601" height="317" fill="url(#gradientMask)" />
          </mask>
        </defs>
        <motion.path
          d="M15.4332 0.0320816C16.3802 0.0329157 17.3271 0.0337499 18.3027 0.0346093C21.4879 0.0386522 24.6731 0.0499368 27.8583 0.0611572C30.1601 0.0655666 32.4619 0.0695285 34.7637 0.0730805C41.0988 0.0841378 47.4338 0.101502 53.7688 0.119855C59.8961 0.137109 66.0234 0.148608 72.1508 0.160675C84.6871 0.185508 97.2234 0.214906 109.76 0.24675C126.879 0.290175 143.999 0.32697 161.119 0.361991C169.093 0.378312 177.068 0.394959 185.043 0.41169C185.841 0.413364 186.639 0.415039 187.462 0.416764C206.465 0.4567 225.468 0.499814 244.471 0.543457C245.719 0.54632 245.719 0.54632 246.991 0.54924C260.485 0.580215 273.978 0.611383 287.472 0.642578C300.114 0.671803 312.756 0.700959 325.398 0.72998C326.229 0.731889 327.06 0.733798 327.916 0.735764C346.884 0.779318 365.852 0.821962 384.821 0.861748C385.618 0.86342 386.415 0.865092 387.236 0.866815C395.193 0.883488 403.151 0.900002 411.108 0.916278C428.209 0.951291 445.309 0.989099 462.41 1.03255C474.875 1.06417 487.34 1.09234 499.805 1.11688C506.561 1.13029 513.316 1.14551 520.071 1.16509C526.251 1.18298 532.431 1.19623 538.611 1.20576C540.85 1.21005 543.09 1.21607 545.329 1.22397C548.366 1.23444 551.404 1.23868 554.441 1.24136C555.316 1.24587 556.191 1.25039 557.093 1.25504C561.829 1.2518 566.311 0.897621 571 0.136719C572.991 0.0511433 574.984 0.00620234 576.977 0.00390625C578.601 0.00197265 578.601 0.00197265 580.258 0C581.369 0.00386718 582.48 0.00773437 583.625 0.0117188C584.744 0.00785156 585.863 0.00398437 587.016 0C588.636 0.00193359 588.636 0.00193359 590.289 0.00390625C591.266 0.00503418 592.242 0.00616211 593.249 0.00732421C595.931 0.133473 598.386 0.53705 601 1.13672C597.103 3.73471 592.944 3.4257 588.438 3.51172C579.68 3.80999 571.104 4.79703 562.438 6.07422C560.662 6.32921 560.662 6.32921 558.851 6.58936C557.744 6.75838 556.637 6.92741 555.496 7.10156C554.508 7.2523 553.52 7.40304 552.502 7.55835C549.771 8.03469 549.771 8.03469 547 10.1367C544.866 10.5374 542.717 10.8629 540.562 11.1367C536.56 11.6467 533.544 12.2383 530 14.1367C527.667 14.4701 525.333 14.8034 523 15.1367C522.34 15.4667 521.68 15.7967 521 16.1367C519 17.1367 519 17.1367 515.5 17.5742C512.061 17.8483 512.061 17.8483 510 19.6367C507.167 21.7616 504.469 21.7582 501 22.1367C500.01 22.4667 499.02 22.7967 498 23.1367C498 23.7967 498 24.4567 498 25.1367C495.69 25.1367 493.38 25.1367 491 25.1367C491 26.1267 491 27.1167 491 28.1367C489.907 28.2192 488.814 28.3017 487.688 28.3867C483.485 29.2415 483.245 29.7691 481 33.1367C478.812 34.1992 478.812 34.1992 476 35.1367C474.686 35.6334 473.374 36.1337 472.062 36.6367C469.629 37.5579 467.256 38.3513 464.75 39.0742C461.921 39.9539 461.921 39.9539 460.062 42.0742C458 44.1367 458 44.1367 454.438 45.6367C450.867 47.1948 450.113 48.0629 448 51.1367C446.337 52.1431 444.67 53.1426 443 54.1367C441.855 55.3433 441.855 55.3433 440.688 56.5742C437.847 59.2831 435.328 60.6067 431.77 62.1445C429.663 63.1493 429.663 63.1493 428 66.1367C426.344 67.2344 426.344 67.2344 424.5 68.1992C422.227 69.3983 420.849 70.2873 419 72.1367C418.198 72.4255 417.396 72.7142 416.57 73.0117C413.586 74.3177 412.691 75.4748 410.875 78.1367C406.128 84.5632 400.008 92.2568 392 94.1367C391.67 95.1267 391.34 96.1167 391 97.1367C389.469 98.5742 389.469 98.5742 387.5 100.137C383.176 103.797 379.772 107.918 376.246 112.336C374.07 115.049 371.846 117.702 369.562 120.324C368.924 121.06 368.286 121.796 367.629 122.555C366 124.137 366 124.137 364 124.137C363.884 124.691 363.768 125.245 363.648 125.816C362.905 128.476 361.845 130.785 360.625 133.262C359.995 134.565 359.995 134.565 359.352 135.895C358 138.137 358 138.137 355 140.137C353.954 141.775 352.96 143.447 352 145.137C351.319 146.127 350.639 147.117 349.938 148.137C347.978 150.947 347.978 150.947 347.062 153.574C345.824 156.56 344.136 158.858 342.227 161.449C340.664 163.599 339.324 165.833 338 168.137C337.67 168.682 337.34 169.227 337 169.789C334.797 173.491 333.339 177.024 332 181.137C331.34 181.797 330.68 182.457 330 183.137C327.685 187.86 326.54 191.848 326 197.137C325.34 197.137 324.68 197.137 324 197.137C323.884 197.839 323.768 198.542 323.648 199.266C322.942 202.392 321.877 205.125 320.625 208.074C320.178 209.129 319.73 210.183 319.27 211.27C318.345 213.358 317.349 215.414 316.312 217.449C314.777 220.592 313.924 223.77 313 227.137C312.67 227.467 312.34 227.797 312 228.137C311.652 229.692 311.346 231.256 311.062 232.824C310.517 235.686 309.941 238.311 309 241.074C307.756 244.883 307.125 248.702 306.465 252.648C306 255.137 306 255.137 305 258.137C304.763 261.393 304.619 264.648 304.477 267.91C304.199 271.427 303.383 274.681 302.504 278.094C300.639 285.868 300.442 293.507 300.312 301.449C300.279 302.883 300.245 304.318 300.209 305.752C300.125 309.213 300.058 312.675 300 316.137C298.35 316.137 296.7 316.137 295 316.137C294.98 315.525 294.96 314.913 294.94 314.283C294.552 302.773 294.04 291.296 293 279.824C292.917 278.895 292.834 277.965 292.749 277.007C292.416 273.513 292.115 270.481 291 267.137C290.637 264.324 290.303 261.518 290 258.699C289.836 257.179 289.669 255.66 289.5 254.141C289.428 253.468 289.356 252.796 289.281 252.104C288.99 250.066 288.532 248.124 288 246.137C287.34 246.137 286.68 246.137 286 246.137C283.998 238.807 282.487 231.727 282 224.137C281.01 223.807 280.02 223.477 279 223.137C278.34 221.246 278.34 221.246 277.938 218.887C277.274 215.41 276.377 212.406 275 209.137C273.784 205.347 272.937 201.839 272.625 197.887C272.416 194.128 272.416 194.128 270.062 192.512C269.382 192.058 268.701 191.604 268 191.137C267.282 189.155 266.626 187.15 266 185.137C265.042 182.516 264.023 179.92 263 177.324C262.74 176.644 262.479 175.964 262.211 175.264C260.943 171.507 260.943 171.507 258 169.137C257.567 168.023 257.567 168.023 257.125 166.887C256.126 164.025 256.126 164.025 253.938 161.762C251.566 158.548 251.308 156.068 251 152.137C250.01 151.807 249.02 151.477 248 151.137C247.876 150.559 247.752 149.982 247.625 149.387C246.704 146.072 244.443 144.524 242 142.137C237.288 136.325 237.288 136.325 236.488 133.023C235.801 130.369 234.176 129.681 232 128.137C232 127.477 232 126.817 232 126.137C230.68 125.807 229.36 125.477 228 125.137C227.876 124.497 227.752 123.858 227.625 123.199C227.419 122.519 227.213 121.838 227 121.137C226.34 120.807 225.68 120.477 225 120.137C224.709 119.526 224.417 118.915 224.117 118.285C222.803 115.758 221.337 114.539 219.125 112.762C215.63 109.807 213.229 107.13 211 103.137C211 102.477 211 101.817 211 101.137C210.402 101.075 209.804 101.013 209.188 100.949C207 100.137 207 100.137 205.676 97.8125C203.777 94.7808 201.979 93.4535 199 91.5117C196.026 89.5559 193.479 87.6808 191 85.1367C189.793 84.4561 189.793 84.4561 188.562 83.7617C185.662 81.9221 184.124 79.8086 182 77.1367C181.34 76.8067 180.68 76.4767 180 76.1367C178 75.1367 178 75.1367 176.062 72.6367C173.754 69.8387 172.303 69.4256 169 68.1367C167.333 66.4701 165.667 64.8034 164 63.1367C159.258 59.6349 154.351 56.6063 149 54.1367C149 53.4767 149 52.8167 149 52.1367C148.165 51.982 148.165 51.982 147.312 51.8242C143.703 50.7512 140.804 49.3399 138.68 46.1602C136.56 43.6068 134.827 43.0772 131.688 42.0742C121.243 38.5422 121.243 38.5422 118.562 35.5117C116.057 33.3065 113.227 33.4411 110 33.1367C109.67 32.1467 109.34 31.1567 109 30.1367C108.237 30.1986 107.474 30.2605 106.688 30.3242C104 30.1367 104 30.1367 102.188 28.7617C101 27.1367 101 27.1367 101 25.1367C100.031 25.0336 99.0612 24.9305 98.0625 24.8242C91.5328 23.8636 85.5951 21.3928 79.522 18.8823C73.6698 16.4688 68.0491 14.4264 61.7578 13.4609C60 13.1367 60 13.1367 59 12.1367C56.0026 11.5971 52.9945 11.1712 49.9805 10.7344C47 10.1367 47 10.1367 45.0195 9.12891C42.2191 7.75304 39.5957 7.55878 36.5 7.19922C35.1651 7.03692 33.8305 6.87275 32.4961 6.70703C31.7779 6.61841 31.0598 6.52979 30.3198 6.43848C25.2193 5.77501 20.1386 4.9692 15.0547 4.1897C10.0439 3.42668 5.03222 2.74336 0 2.13672C0 1.80672 0 1.47672 0 1.13672C5.19253 0.0737073 10.1615 0.00494245 15.4332 0.0320816Z"
          fill="white"
          stroke="white"
          strokeWidth="2"
          initial={{ fillOpacity: 0 }}
          animate={controls}
        />

        <motion.path
          d="M15.4332 0.0320816C16.3802 0.0329157 17.3271 0.0337499 18.3027 0.0346093C21.4879 0.0386522 24.6731 0.0499368 27.8583 0.0611572C30.1601 0.0655666 32.4619 0.0695285 34.7637 0.0730805C41.0988 0.0841378 47.4338 0.101502 53.7688 0.119855C59.8961 0.137109 66.0234 0.148608 72.1508 0.160675C84.6871 0.185508 97.2234 0.214906 109.76 0.24675C126.879 0.290175 143.999 0.32697 161.119 0.361991C169.093 0.378312 177.068 0.394959 185.043 0.41169C185.841 0.413364 186.639 0.415039 187.462 0.416764C206.465 0.4567 225.468 0.499814 244.471 0.543457C245.719 0.54632 245.719 0.54632 246.991 0.54924C260.485 0.580215 273.978 0.611383 287.472 0.642578C300.114 0.671803 312.756 0.700959 325.398 0.72998C326.229 0.731889 327.06 0.733798 327.916 0.735764C346.884 0.779318 365.852 0.821962 384.821 0.861748C385.618 0.86342 386.415 0.865092 387.236 0.866815C395.193 0.883488 403.151 0.900002 411.108 0.916278C428.209 0.951291 445.309 0.989099 462.41 1.03255C474.875 1.06417 487.34 1.09234 499.805 1.11688C506.561 1.13029 513.316 1.14551 520.071 1.16509C526.251 1.18298 532.431 1.19623 538.611 1.20576C540.85 1.21005 543.09 1.21607 545.329 1.22397C548.366 1.23444 551.404 1.23868 554.441 1.24136C555.316 1.24587 556.191 1.25039 557.093 1.25504C561.829 1.2518 566.311 0.897621 571 0.136719C572.991 0.0511433 574.984 0.00620234 576.977 0.00390625C578.601 0.00197265 578.601 0.00197265 580.258 0C581.369 0.00386718 582.48 0.00773437 583.625 0.0117188C584.744 0.00785156 585.863 0.00398437 587.016 0C588.636 0.00193359 588.636 0.00193359 590.289 0.00390625C591.266 0.00503418 592.242 0.00616211 593.249 0.00732421C595.931 0.133473 598.386 0.53705 601 1.13672C597.103 3.73471 592.944 3.4257 588.438 3.51172C579.68 3.80999 571.104 4.79703 562.438 6.07422C560.662 6.32921 560.662 6.32921 558.851 6.58936C557.744 6.75838 556.637 6.92741 555.496 7.10156C554.508 7.2523 553.52 7.40304 552.502 7.55835C549.771 8.03469 549.771 8.03469 547 10.1367C544.866 10.5374 542.717 10.8629 540.562 11.1367C536.56 11.6467 533.544 12.2383 530 14.1367C527.667 14.4701 525.333 14.8034 523 15.1367C522.34 15.4667 521.68 15.7967 521 16.1367C519 17.1367 519 17.1367 515.5 17.5742C512.061 17.8483 512.061 17.8483 510 19.6367C507.167 21.7616 504.469 21.7582 501 22.1367C500.01 22.4667 499.02 22.7967 498 23.1367C498 23.7967 498 24.4567 498 25.1367C495.69 25.1367 493.38 25.1367 491 25.1367C491 26.1267 491 27.1167 491 28.1367C489.907 28.2192 488.814 28.3017 487.688 28.3867C483.485 29.2415 483.245 29.7691 481 33.1367C478.812 34.1992 478.812 34.1992 476 35.1367C474.686 35.6334 473.374 36.1337 472.062 36.6367C469.629 37.5579 467.256 38.3513 464.75 39.0742C461.921 39.9539 461.921 39.9539 460.062 42.0742C458 44.1367 458 44.1367 454.438 45.6367C450.867 47.1948 450.113 48.0629 448 51.1367C446.337 52.1431 444.67 53.1426 443 54.1367C441.855 55.3433 441.855 55.3433 440.688 56.5742C437.847 59.2831 435.328 60.6067 431.77 62.1445C429.663 63.1493 429.663 63.1493 428 66.1367C426.344 67.2344 426.344 67.2344 424.5 68.1992C422.227 69.3983 420.849 70.2873 419 72.1367C418.198 72.4255 417.396 72.7142 416.57 73.0117C413.586 74.3177 412.691 75.4748 410.875 78.1367C406.128 84.5632 400.008 92.2568 392 94.1367C391.67 95.1267 391.34 96.1167 391 97.1367C389.469 98.5742 389.469 98.5742 387.5 100.137C383.176 103.797 379.772 107.918 376.246 112.336C374.07 115.049 371.846 117.702 369.562 120.324C368.924 121.06 368.286 121.796 367.629 122.555C366 124.137 366 124.137 364 124.137C363.884 124.691 363.768 125.245 363.648 125.816C362.905 128.476 361.845 130.785 360.625 133.262C359.995 134.565 359.995 134.565 359.352 135.895C358 138.137 358 138.137 355 140.137C353.954 141.775 352.96 143.447 352 145.137C351.319 146.127 350.639 147.117 349.938 148.137C347.978 150.947 347.978 150.947 347.062 153.574C345.824 156.56 344.136 158.858 342.227 161.449C340.664 163.599 339.324 165.833 338 168.137C337.67 168.682 337.34 169.227 337 169.789C334.797 173.491 333.339 177.024 332 181.137C331.34 181.797 330.68 182.457 330 183.137C327.685 187.86 326.54 191.848 326 197.137C325.34 197.137 324.68 197.137 324 197.137C323.884 197.839 323.768 198.542 323.648 199.266C322.942 202.392 321.877 205.125 320.625 208.074C320.178 209.129 319.73 210.183 319.27 211.27C318.345 213.358 317.349 215.414 316.312 217.449C314.777 220.592 313.924 223.77 313 227.137C312.67 227.467 312.34 227.797 312 228.137C311.652 229.692 311.346 231.256 311.062 232.824C310.517 235.686 309.941 238.311 309 241.074C307.756 244.883 307.125 248.702 306.465 252.648C306 255.137 306 255.137 305 258.137C304.763 261.393 304.619 264.648 304.477 267.91C304.199 271.427 303.383 274.681 302.504 278.094C300.639 285.868 300.442 293.507 300.312 301.449C300.279 302.883 300.245 304.318 300.209 305.752C300.125 309.213 300.058 312.675 300 316.137C298.35 316.137 296.7 316.137 295 316.137C294.98 315.525 294.96 314.913 294.94 314.283C294.552 302.773 294.04 291.296 293 279.824C292.917 278.895 292.834 277.965 292.749 277.007C292.416 273.513 292.115 270.481 291 267.137C290.637 264.324 290.303 261.518 290 258.699C289.836 257.179 289.669 255.66 289.5 254.141C289.428 253.468 289.356 252.796 289.281 252.104C288.99 250.066 288.532 248.124 288 246.137C287.34 246.137 286.68 246.137 286 246.137C283.998 238.807 282.487 231.727 282 224.137C281.01 223.807 280.02 223.477 279 223.137C278.34 221.246 278.34 221.246 277.938 218.887C277.274 215.41 276.377 212.406 275 209.137C273.784 205.347 272.937 201.839 272.625 197.887C272.416 194.128 272.416 194.128 270.062 192.512C269.382 192.058 268.701 191.604 268 191.137C267.282 189.155 266.626 187.15 266 185.137C265.042 182.516 264.023 179.92 263 177.324C262.74 176.644 262.479 175.964 262.211 175.264C260.943 171.507 260.943 171.507 258 169.137C257.567 168.023 257.567 168.023 257.125 166.887C256.126 164.025 256.126 164.025 253.938 161.762C251.566 158.548 251.308 156.068 251 152.137C250.01 151.807 249.02 151.477 248 151.137C247.876 150.559 247.752 149.982 247.625 149.387C246.704 146.072 244.443 144.524 242 142.137C237.288 136.325 237.288 136.325 236.488 133.023C235.801 130.369 234.176 129.681 232 128.137C232 127.477 232 126.817 232 126.137C230.68 125.807 229.36 125.477 228 125.137C227.876 124.497 227.752 123.858 227.625 123.199C227.419 122.519 227.213 121.838 227 121.137C226.34 120.807 225.68 120.477 225 120.137C224.709 119.526 224.417 118.915 224.117 118.285C222.803 115.758 221.337 114.539 219.125 112.762C215.63 109.807 213.229 107.13 211 103.137C211 102.477 211 101.817 211 101.137C210.402 101.075 209.804 101.013 209.188 100.949C207 100.137 207 100.137 205.676 97.8125C203.777 94.7808 201.979 93.4535 199 91.5117C196.026 89.5559 193.479 87.6808 191 85.1367C189.793 84.4561 189.793 84.4561 188.562 83.7617C185.662 81.9221 184.124 79.8086 182 77.1367C181.34 76.8067 180.68 76.4767 180 76.1367C178 75.1367 178 75.1367 176.062 72.6367C173.754 69.8387 172.303 69.4256 169 68.1367C167.333 66.4701 165.667 64.8034 164 63.1367C159.258 59.6349 154.351 56.6063 149 54.1367C149 53.4767 149 52.8167 149 52.1367C148.165 51.982 148.165 51.982 147.312 51.8242C143.703 50.7512 140.804 49.3399 138.68 46.1602C136.56 43.6068 134.827 43.0772 131.688 42.0742C121.243 38.5422 121.243 38.5422 118.562 35.5117C116.057 33.3065 113.227 33.4411 110 33.1367C109.67 32.1467 109.34 31.1567 109 30.1367C108.237 30.1986 107.474 30.2605 106.688 30.3242C104 30.1367 104 30.1367 102.188 28.7617C101 27.1367 101 27.1367 101 25.1367C100.031 25.0336 99.0612 24.9305 98.0625 24.8242C91.5328 23.8636 85.5951 21.3928 79.522 18.8823C73.6698 16.4688 68.0491 14.4264 61.7578 13.4609C60 13.1367 60 13.1367 59 12.1367C56.0026 11.5971 52.9945 11.1712 49.9805 10.7344C47 10.1367 47 10.1367 45.0195 9.12891C42.2191 7.75304 39.5957 7.55878 36.5 7.19922C35.1651 7.03692 33.8305 6.87275 32.4961 6.70703C31.7779 6.61841 31.0598 6.52979 30.3198 6.43848C25.2193 5.77501 20.1386 4.9692 15.0547 4.1897C10.0439 3.42668 5.03222 2.74336 0 2.13672C0 1.80672 0 1.47672 0 1.13672C5.19253 0.0737073 10.1615 0.00494245 15.4332 0.0320816Z"
          fill="black"
          mask="url(#triangleMask)"
        />
      </svg>
    </motion.div>
  )
}
